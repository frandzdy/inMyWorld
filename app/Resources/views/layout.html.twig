{# app/Resources/views/layout.html.twig #}

<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>{% block title %}OC Plateforme{% endblock %}</title>

  {% block stylesheets %}
    {# On charge le CSS de bootstrap depuis le site directement #}
    <link href="{{ asset('assets/stylesheets/screen.css') }}" media="screen, projection" rel="stylesheet" type="text/css" />
    <link href="{{ asset('assets/stylesheets/print.css') }}" media="print" rel="stylesheet" type="text/css" />
    <!--[if IE]>
    	<link href="{{ asset('assets/stylesheets/ie.css') }}" media="screen, projection" rel="stylesheet" type="text/css" />
  	<![endif]-->
    <link rel="stylesheet" href="{{ asset('bootstrap/css/bootstrap.min.css') }}">
    {# <link href="assets/css/bootstrap.css" rel="stylesheet"> #}
	<style type="text/css">
	  	body { padding-top: 70px; }
  		img { width: 100%; }
  		.well {
        	background-color:#CCC;
        	padding: 20px;
      	}
  		a:active, a:focus { outline:none; }
  		.inline-form input {
	        display: inline-block;
	        width: 100px;
      	}
	</style>
  {% endblock %}
</head>

<body>
	<div class="container">
		{# Si l'utilisateur a un role admin #}
    	<nav class="navbar navbar-inverse navbar-fixed-top">
    		<div class="navbar-header col-md-2 col-sm-2 col-xs-2">
		    	<a class="navbar-brand" href="{{ path('oc_platform_home') }}">OC Plateforme</a>
		  	</div>
    		<div class="container-fluid col-md-2 col-md-offset-8 col-sm-2 col-sm-offset-8 col-xs-2 col-xs-offset-8">
				<ul class="nav navbar-nav navbar-left pull-right">
					{# <form method="post" action="{{ path('oc_platform_recherche') }}" class="navbar-form navbar-left inline-form  pull-left" role="form" >
     	 				<div class="form-group">
	        				<input type="search" name="search" class="input-sm form-control" placeholder="Recherche">
	        				<button type="submit" class="btn btn-primary btn-sm"><span class="glyphicon glyphicon-eye-open"></span> Chercher</button>
      					</div>
    				</form> 
					<li><a href="{{ path('oc_platform_home') }}">Accueil</a></li> #}
					{% if is_granted("ROLE_ADMIN") %}
			  			
					{% endif %}
					{% if app.user is not null %}
		      			<li class="dropdown pull-right">
		      				<a data-toggle="dropdown" href="#">
		      					{% if app.user.image is not null %}
								  	<img src="{{ asset(app.user.image.PathView)}}" alt="{{app.user.image.alt }}" style="width:40px" >
								{% endif %}
								{{ app.user.username }} <b class="caret"></b>
							</a>
			      			<ul class="dropdown-menu">
				                <li><a href="{{ path('oc_platform_editUser', {'id' : app.user.id}) }}"><span class="glyphicon glyphicon-user"></span> Mon profil</a></li>
				                <li><a href="#">Chasseurs</a></li>
				                <li><a href="{{ path('oc_platform_add') }}">Ajouter une annonce</a></li>
								<li><a href="{{ path('oc_platform_addUser') }}">Créer un utilisateur</a></li>
								<li><a href="{{ path('oc_platform_afficheUser') }}">Liste des utilisateurs</a></li>
				                <li class="divider"></li>
				                <li><a href="#"><span class="glyphicon glyphicon-cog"></span> Préférences</a></li>
				                <li><a href="{{ path('fos_user_security_logout') }}">Déconnexion</a></li>
		              		</ul>
		              	</li>
			      	{% else %}
				      	<form class="navbar-form navbar-right inline-form" role="form" >
	     	 				<div class="form-group">
				      			<a class="btn btn-primary btn-sm" href="{{ path('fos_user_security_login') }}"><span class="glyphicon glyphicon-user"></span> Se connecter</a>
				      		</div>
				      	</form>
			      	{% endif %}
				</ul>
			</div>
		</nav>
    	<div id="header" class="jumbotron">
    		<h1>Ma plateforme d'annonces</h1>
    			<p>
	        		Ce projet est propulsé par Symfony2,
	        		et construit grâce au MOOC OpenClassrooms et SensioLabs.
    			</p>
    			<p class="pull-left">
		        	<a class="btn btn-primary btn-lg" href="http://fr.openclassrooms.com/informatique/cours/developpez-votre-site-web-avec-le-framework-symfony2">
		          		Participer au MOOC »
		    		</a>
    			</p>
    	</div>
		<div class="row">
	      	<div id="content" class="col-md-12">
	        	{% block body %}
	        		{# le body du template viens ici #}
	        	{% endblock %}
	      	</div>
	      	{#<div id="menu" class="col-md-4">
				<button class="btn pull-right" data-toggle="collapse" data-target="#chat">chat</button>
				<div style="background: white none repeat scroll 0% 0%;" id="chat" class="collapse in">
		 	 		{{ render(path('oc_chat_main', {'name':'moi'})) }}
		 	 		<div class="input-group input-group-md">
		 				<input type="text" class="form-control" style="text-align:left" id="textSend" value="">
		 				<input type="hidden" class="form-control" style="text-align:left" id="urlAjaxChat" value="{{ path('oc_chat_ajax') }}">
					    <span class="input-group-btn">
				      		<button id="send" class="btn btn-default" type="button">Envoyer</button>
					    </span>
				    </div>
				</div>
	      	</div>#}
	    </div>
	
	    <hr>

	    <footer>
	    	<div class="row">
	    		<div class="col-md-12" >
	    			 <p>The sky's the limit © {{ 'now'|date('Y') }} and beyond.</p>
	    		</div>
	    	</div>
	    </footer>
  	</div>

  {% block javascripts %}
    	{# Ajoutez ces lignes JavaScript si vous comptez vous servir des fonctionnalités du bootstrap Twitter #}
      	<script src="{{ asset('bootstrap/js/jquery-2.1.4.js') }}"></script>
      	<script src="{{ asset('bootstrap/js/bootstrap.min.js') }}"></script>
      	<script type="text/javascript">
      	$(function(){
      		$('#send').click(function(){
      			var text = $('#textSend').val().toString();
      			var url = $('#urlAjaxChat').val().toString();
      			$(this).addClass('btn-primary');
      			alert(text);
      			
      			$.ajax( {
				  url: url,
				  method: "POST",
				  data: { text : text },
				  dataType: "json"
					}).done(function(data) {
				    alert( "success"+data.text );
				    $('#sourceChat').append(data.text);
				  })
				  .fail(function() {
				    alert( "error" );
				  })
				  .always(function() {
				    alert( "complete" );
				  });
      			
      		});
      	});
      	</script>
  {% endblock %}

</body>
</html>